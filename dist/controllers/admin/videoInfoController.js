"use strict";var path=require("path"),mongoose=require("mongoose"),videoInfoModel=mongoose.model("videoInfo");exports.list=function(o,e){videoInfoModel.find({},function(o,n){if(o)throw o;e.render(path.join(__dirname,"../../views/admin/index"),{title:"学习资源管理",videoArr:n})})},exports.add=function(o,e){e.end("add page")},exports.addData=function(o,e){videoInfoModel.create({name:o.body.name,scope:o.body.scope,keyword:o.body.keyword,src:o.body.src,notedata:o.body.notedata},function(o){e.set({"Content-Type":"application/json; charset=UTF-8"}),e.end(JSON.stringify({status:1,message:"数据新增成功"}))})},exports.findModel=function(o,e){var n=o.params.id;videoInfoModel.findOne({_id:n},function(o,n){if(o)throw o;e.render(path.join(__dirname,"../../views/admin/edit"),n)})},exports.update=function(o,e){console.log(o.body);var n=o.body.vid,t=o.body.name,d=o.body.scope,i=o.body.keyword,a=o.body.notedata;videoInfoModel.update({_id:n},{name:t,scope:d,keyword:i,notedata:a},{},function(o){if(o)throw o;e.set({"Content-Type":"text/html; charset=UTF-8"}),e.end("<script>alert('更新成功');window.location='/admin/videoInfo'</script>")})},exports["delete"]=function(o,e){var n=o.params.id;videoInfoModel.remove({_id:n},function(o){if(o)throw o;e.set({"Content-Type":"application/json; charset=UTF-8"}),e.end(JSON.stringify({status:1,message:"数据删除成功"}))})};